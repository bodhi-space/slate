<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_publishingapps">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <a class="bodhi-logo" href="http://docs.bodhi.space"> <img src="../images/logo.png" /> </a>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="publishing-applications">Publishing Applications</h1>

<h2 id="overview">Overview</h2>

<p>To publish application for the IoT Platform, you need to follow a few simple steps to describe your application.  </p>

<h3 id="publishing-your-application">Publishing Your Application</h3>

<p>To publish your application you must have the following directory structure for your application:</p>
<pre class="highlight plaintext"><code>    /&lt;app-name&gt;/
            /www/
                /public/
</code></pre>

<ul>
<li>Folder (npm app-name)</li>
<li>Inside the www folder under app-name must contain the following:

<ul>
<li>index.html (could be empty)</li>
<li>LICENSE (standard apache license file)</li>
<li>package.json (example provided below) </li>
<li>public (folder) 

<ul>
<li>app icon.png</li>
<li>NewType1.json file</li>
<li>NewType2.json file</li>
<li>NewType3.json file</li>
</ul></li>
</ul></li>
</ul>

<p>To publish an app into the IoT Platform you have to zip up a folder containing the following:
{code}</p>

<p>folder=<app-name>
        folder=<www>
            index.html (could be empty)
            LICENSE
            package.json</p>

<p>folder=<public>
                app_icon.png
                NewType1.json file
                NewType2.json file
                NewType3.josn file
                &hellip;</p>

<p>Example of Package.json :: </p>
<pre class="highlight plaintext"><code>#!javascript

{
  "name": "app-package-name",
  "version": "0.0.1",
  "title": "Application Title",
  "description": "Short Application Description.",
  "profile": {
    "name": "app-package-name",
    "dml": {
      “BodhiApplication": {
       "select": {},
       "update":{},
       "delete":{},
       "insert":{}
      },
      "NewType1": {
        "select": {}
      },
      "NewType2": {
        "select": {}
      }
    }
  },
  "settings": {
    "categories": [
      "Aloha",
      "POS"
    ],
    "publisher": "your company",
    "npm_package_name": "app-package-name",


if you have any related apps you want to install together::
"related-apps": [
      "bodhi.aloha-app-transactions",
      "bodhi.aloha-app-store"
    ],
    "public_path": "public",
    "global_store_icon": "public/icon.png",
   "type": "agent",    
(type can be “job”, “agent”, “mobile”, “web” )   
 "new_type_required": true,
  "install": {
"new": {
"model": [
{
"type": "enumeration",
"name": "TypeName",
"object": "Enumerations/TypeName.json"
},
{
"type": "embedded_type",
"name": "InventoryPurchaseOrder",
"object": "Types/InventoryPurchaseOrder.json"
},
{ "type": "custom_type",
"name": "TypeName2",
"object": "Types/TypeName2.json"
}
],
"post-type-install": [
{"action": "POST",
"object": "Data/DataFile.json",
"path": "/resources/DataFile"
}
]
if you have any parameters required to be used with the app we add this section:: 
 "agent_parameters": {
      "interval": {
        "description": "How often to execute a grind",
        "required": true,
        "type": "string",
        "default": "every 15 minutes",
        "position": 1
      }
    }
  },
  "autoUpdateVersion": false
}

</code></pre>

<h3 id="generic-package.json-flags">Generic package.json flags</h3>

<p><strong>type=job/agent/mobile/web</strong></p>

<p>In the setting section, you define the type of application (job, agent, mobile or web) you are publishing.  The &ldquo;type&rdquo;=&ldquo;job&rdquo; define your application to run inside job engine through Job Engine Manager.  The &ldquo;type&rdquo;=&ldquo;agent&rdquo; defines your application to run with the agent based on a defined role.  The &ldquo;type&rdquo;=&ldquo;mobile&rdquo; defines your application to run in a mobile container usually Bodhi Mobile.  The &ldquo;type&rdquo;=&ldquo;web&rdquo; defines your application to run as a web application. </p>

<p><strong>agent_parameters/job_parameters</strong></p>

<p>Depending on your application needs, you may want to have parameters setup for your applications.  Both Agent and Job applications can take parameters.  The following are examples of parameters that can be set for agent or the job applications respectively:</p>

<p>Agent Parameters example:</p>
<pre class="highlight plaintext"><code>    "agent_parameters": {
      "config_file_path": {
        "description": "Config file location",
        "required": true,
        "type": "string",
        "default": "",
        "setting": "config_file_path"
      },
      "data_dir": {
        "description": "Folder location to save database files for the agent app",
        "required": true,
        "type": "string",
        "default": "C:/bodhiAgent/node_modules/merit-agent-labor/_xmloutput/",
        "setting": "data_dir"
      },
      "number_of_days_to_query": {
        "description": "Limit query to this number of days",
        "required": true,
        "type": "integer",
        "default": 60,
        "setting": "number_of_days_to_query"
      },
      "interval": {
        "description": "How often to execute a grind",
        "required": true,
        "type": "string",
        "default": "every 12 hours",
        "setting": "interval"
      },
      "local_storage_ignore_flag": {
        "description": "Ignore local storage and write all data",
        "required": true,
        "type": "boolean",
        "default": false,
        "setting": "local_storage_ignore_flag"
      }
    }
</code></pre>

<p>This example sets up four parameters: timing_expression, brink_location, accessToken and uri.
Job Parameters example:</p>
<pre class="highlight plaintext"><code>    "job_parameters": {
      "timing_expression": {
        "description": "How often to execute a job",
        "repeat": true,
        "type": "string",
        "default": "60 minutes"
      },
      "brink_location": {
        "description": "The alpha numeric string provided by the Brink POS API to identify the store location, e.g. tSm8y1TMSk7J4ZMyQBpeTg==",
        "type": "string",
        "required": true,
        "setting": "brink_location"
      },
      "accessToken": {
        "description": "The alpha numeric string provided by the Brink POS API to authenticate the user",
        "type": "string",
        "required": true,
        "setting": "accessToken"
      },
      "uri": {
        "description": "The url for the Brink POS API service e.g. https://api2.brinkpos.net/",
        "type": "string",
        "required": true,
        "setting": "uri"
      }
    }
</code></pre>

<p><strong>offline=true/false</strong>  </p>

<p>Offline controls whether the container will cache application information for offline use. If offline=true and the user launches the application, any data that was previously loaded will be available when the device is offline. This will also enable queuing of data to write to the Bodhi Cloud if the app has write permissions.</p>

<p><strong>single_container_app=true/false</strong>  </p>

<p>single_container_app the container know whether the app should be displayed with a menu (a collection of apps) or as a standalone single app.
Bodhi Mobile has single_container_app = false. Bodhi Reveal has single_container_app = true</p>

<p><strong>hide_from_global_store=true/false</strong>  </p>

<p>hide_from_global_store controls whether the app is available to the general public to see in the global app store. Apps like Settings which cannot be removed should have hide_from_global_store=true</p>

<p><strong>new_type_required=true/false</strong>  </p>

<p>new_type_required tells the installer of the app in the global app store if the app will run &lsquo;out of the box&rsquo; or if new custom types need to be installed on the namespace.
NOTE:: if new_type_required=true, troubleshooting_url should be required</p>

<p><strong>categories {}</strong>  </p>

<p>The categories array allows you to give the Bodhi app store taxonomical information about how your app relates to other applications. 
Examples include financial, inventory, mangagement</p>

<p><strong>public_path&rsquo;/xxx/xxx&rsquo;</strong> </p>

<p>The Public Path is a location off of root that allows developers to save items that should be publically visable and available. The Public Path folder should contain screenshots and Icons that the global app store can use. The global_store_icon as well as the screenshots settings objects should all be relative paths to the public path.</p>

<p><strong>global_store_icon=&rsquo;/xxx/xxx.png&rsquo;</strong>  </p>

<p>The global_store_icon is the icon that the Global App Store will use for display purposes. This file should be included in the app folder that is published via app tools and the path should be relative to the public_path.</p>

<p><strong>screenshots{}</strong> </p>

<p>The screenshots array contains relative paths to screenshots which the Global App Store will use for display purposes. This files should be included in the app folder that is published via app tools and the path should be relative to the public_path.</p>

<p><strong>agent/job_parameters:{}</strong> and <strong>agent/job_parameters_hidden:{}</strong></p>

<p>The agent/job_parameters contain information about any parameters that the agent or job requires to run.  They contain data_dir formatted information containing description, a required flag, type string and an optional position which is set will position the parameter in the order set 0, 1, 2, etc if not set then the parameter will be displayed in the order it&rsquo;s defined. Application parameters will be saved under settings so the application should use parameters from settings.</p>

<p>NOTE: The hidden parameter option will not be visible to the user in the installation process but will be written under the application settings.</p>

<p><strong>data_dir:{}</strong></p>

<p>The data_dir formatted information contains a description, a required flag, type string and an optional position which is set will position the parameter in the order set 0, 1, 2, etc if not set then the parameter will be displayed in the order it&rsquo;s defined.</p>

<p><strong>autoUpdateVersion&quot;: false</strong></p>

<p>This flag prevents autoUpdate version of the app each time you are publishing it.  If you mark this false, you need to manually bump the version of the app each time you update it.  </p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
